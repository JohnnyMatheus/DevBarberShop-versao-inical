<h1 align="center">üíà&lt;DevBarberShop/&gt;üíà</h1>


## üî∑T√≥picos 
- [Descri√ß√£o do projeto](#descri√ß√£o-do-projeto)
- [Ferramentas utilizadas](#ferramentas-utilizadas)
- [Modelagem](#Modelagem)
- [Script Banco de dados](#Script-Banco-de-Dados)
- [Desenvolvedores](#Desenvolvedores)
- [Professor](#Professor)

## üî∑Descri√ß√£o do projeto
<p>Projeto em desenvolvimento para disciplina Banco de dados I do curso de Ci√™ncias da Computa√ß√£o. O projeto tem por objetivo por em pr√°tica os conhecimentos adquiridos em aula.</p>
<p>O modelo relacional apresentado √© projetado para gerenciar eficientemente as opera√ß√µes de uma barbearia, incluindo clientes, funcion√°rios, servi√ßos, agendamentos, pagamentos, estoque de produtos e hist√≥rico de servi√ßos realizados.</p>

## ‚öíÔ∏èFerramentas utilizadas
| [<img src="https://wiki.postgresql.org/images/3/30/PostgreSQL_logo.3colors.120x120.png" width=115><br><sub>Postgresql</sub>](https://www.postgresql.org/download/) |  [<img src="https://freesoft.ru/storage/images/221/2207/220636/220636_normal.png" width=115><br><sub>Visual Paradigm 17.1</sub>](https://www.visual-paradigm.com/download/community.jsp) | [<img src="https://dbeaver.io/wp-content/uploads/2015/09/beaver-head.png" width=115><br><sub>DBeaver</sub>](https://dbeaver.io)
| :---: | :---: | :---: 


## ‚öôÔ∏èModelagem
Voc√™ pode [acessar a modelagem do projeto aqui](https://github.com/JohnnyMatheus/DevBarberShop/tree/main/Modelagem)

<img src="https://github.com/JohnnyMatheus/DevBarberShop/blob/main/imagens/modelagem-atualizada.png">

<h1 align="center">üé≤Script Banco de dados</h1>
Voc√™ pode [acessar o c√≥digo fonte do projeto](https://github.com/JohnnyMatheus/DevBarberShop/tree/main/Script)

## üé≤Script - Cria√ß√£o do Banco do Dados
```sql
--Script - cria√ß√£o do Banco do Dados
create database devbarbershop;

```
## üé≤Script - cria√ß√£o Tabelas
```sql
-- Script de cria√ß√£o de tabelas

create table cliente(
    codcli int generated by default as identity primary key,
    nomcli varchar(150) not null,
    telcli varchar(20) not null,
    emailcli varchar(100) not null,
    bairrocli varchar(100) not null,
    ruaendcli varchar(100) not null,
    sexocli varchar(10) not null,
    cidadecli varchar(50) not null,
    dtnascli date not null
);

comment on table cliente is 'Tabela de clientes da Barbearia';
comment on column cliente.codcli is 'C√≥digo do cliente';
comment on column cliente.nomcli is 'Nome do cliente';
comment on column cliente.telcli is 'Telefone do cliente';
comment on column cliente.emailcli is 'E-mail do cliente';
comment on column cliente.bairrocli is 'Bairro do cliente';
comment on column cliente.ruaendcli is 'Rua do endere√ßo do cliente';
comment on column cliente.sexocli is 'Sexo do cliente';
comment on column cliente.cidadecli is 'Cidade do cliente';
comment on column cliente.dtnascli is 'Data de nascimento do cliente';

-----------------------------------------------------------------------------------------------

create table fornecedor(
    codforn int generated by default as identity primary key,
    nomeforn varchar(150) not null,
    telforn varchar(20),
    emailforn varchar(100),
    enderecoforn varchar(100)
);

comment on table fornecedor is 'Tabela de fornecedores';
comment on column fornecedor.codforn is 'C√≥digo do fornecedor';
comment on column fornecedor.nomeforn is 'Nome do fornecedor';
comment on column fornecedor.telforn is 'Telefone do fornecedor';
comment on column fornecedor.emailforn is 'E-mail do fornecedor';
comment on column fornecedor.enderecoforn is 'Endere√ßo do fornecedor';

-----------------------------------------------------------------------------------------------

create table funcionario(
    codfun int generated by default as identity primary key,
    nomefun varchar(100) not null,
    telfun varchar(20) not null,
    emailfun varchar(100) not null,
    cargofun varchar(100) not null,
    salariofun numeric(10, 2) not null
);

comment on table funcionario is 'Tabela de funcion√°rios da Barbearia';
comment on column funcionario.codfun is 'C√≥digo do funcion√°rio';
comment on column funcionario.nomefun is 'Nome do funcion√°rio';
comment on column funcionario.telfun is 'Telefone do funcion√°rio';
comment on column funcionario.emailfun is 'E-mail do funcion√°rio';
comment on column funcionario.cargofun is 'Cargo do funcion√°rio';
comment on column funcionario.salariofun is 'Sal√°rio do funcion√°rio';

-----------------------------------------------------------------------------------------------

create table servico(
    codserv int generated by default as identity primary key,
    nomeserv varchar(100) not null,
    descserv varchar(100),
    precoserv numeric(10, 2) not null
);

comment on table servico is 'Tabela de servi√ßos oferecidos pela Barbearia';
comment on column servico.codserv is 'C√≥digo do Servi√ßo';
comment on column servico.nomeserv is 'Nome do servi√ßo';
comment on column servico.descserv is 'Descri√ß√£o do servi√ßo oferecido pela Barbearia';
comment on column servico.precoserv is 'Pre√ßo dos servi√ßos oferecidos pela Barbearia';

-----------------------------------------------------------------------------------------------

create table produto(
    codprod int generated by default as identity primary key,
    nomeprod varchar(100) not null,
    descprod varchar(255),
    qtdprod int not null,
    precoprod numeric(10, 2) not null,
    fornecedorcodforn int references fornecedor(codforn),
    servicocodserv int references servico(codserv)
);

comment on table produto is 'Tabela de produtos';
comment on column produto.codprod is 'C√≥digo do produto';
comment on column produto.nomeprod is 'Nome do produto';
comment on column produto.descprod is 'Descri√ß√£o do produto';
comment on column produto.qtdprod is 'Quantidade do produto em estoque';
comment on column produto.precoprod is 'Pre√ßo do produto';
comment on column produto.fornecedorcodforn is 'C√≥digo do fornecedor do produto';
comment on column produto.servicocodserv is 'C√≥digo do servi√ßo relacionado ao produto';

-----------------------------------------------------------------------------------------------

create table agendamento(
    codagen int generated by default as identity primary key,
    data_hora timestamp not null,
    status varchar(50) not null,
    clientecodcli int references cliente(codcli),
    funcionariocodfun int references funcionario(codfun)
);

comment on table agendamento is 'Tabela de agendamentos';
comment on column agendamento.codagen is 'C√≥digo do agendamento';
comment on column agendamento.data_hora is 'Data e hora do agendamento';
comment on column agendamento.status is 'Status do agendamento';
comment on column agendamento.clientecodcli is 'C√≥digo do cliente';
comment on column agendamento.funcionariocodfun is 'C√≥digo do funcion√°rio';

-----------------------------------------------------------------------------------------------

create table pagamento(
    codpag int generated by default as identity primary key,
    valor numeric(10, 2) not null,
    data_hora_pagamento timestamp not null,
    forma_pagamento varchar(50) not null,
    clientecodcli int references cliente(codcli),
    agendamentocodagen int references agendamento(codagen)
);

comment on table pagamento is 'Tabela de pagamentos';
comment on column pagamento.codpag is 'C√≥digo do pagamento';
comment on column pagamento.valor is 'Valor do pagamento';
comment on column pagamento.data_hora_pagamento is 'Data e hora do pagamento';
comment on column pagamento.forma_pagamento is 'Forma de pagamento';
comment on column pagamento.clientecodcli is 'C√≥digo do cliente';
comment on column pagamento.agendamentocodagen is 'C√≥digo do agendamento';

-----------------------------------------------------------------------------------------------

create table historico_servico(
    codhistorico int generated by default as identity primary key,
    data_hora timestamp not null,
    servicocodserv int references servico(codserv),
    clientecodcli int references cliente(codcli),
    funcionariocodfun int references funcionario(codfun)
);

comment on table historico_servico is 'Tabela de hist√≥rico de servi√ßos prestados';
comment on column historico_servico.codhistorico is 'C√≥digo do hist√≥rico de servi√ßo';
comment on column historico_servico.data_hora is 'Data e hora do servi√ßo';
comment on column historico_servico.servicocodserv is 'C√≥digo do servi√ßo';
comment on column historico_servico.clientecodcli is 'C√≥digo do cliente';
comment on column historico_servico.funcionariocodfun is 'C√≥digo do funcion√°rio';


```
## üé≤Script - Inserir dados na Tabela
```sql
-- Inserts para Clientes
insert into cliente (nomcli, telcli, emailcli, bairrocli, ruaendcli, sexocli, cidadecli, dtnascli) values
    ('Nelson Ramos Rodrigues Junior', '(49) 9999-9999', 'nelson@example.com', 'Centro', 'Rua A', 'Masculino', 'S√£o Miguel do Oeste', '1990-05-15'),
    ('Nathaniel Nicolas Rissi Soares', '(49) 8888-8888', 'nathaniel@example.com', 'Agostini', 'Rua B', 'Masculino', 'Maravilha', '1995-08-20'),
    ('Ira√™ Ervin Gruber da Silva', '(49) 7777-7777', 'irae@example.com', 'Centro', 'Rua C', 'Masculino', 'Descanso', '1992-03-10'),
    ('Jefferson Alan Schmidt Ludwig', '(49) 6666-6666', 'jefferson@example.com', 'Agostini', 'Rua D', 'Masculino', 'Itapiranga', '1998-11-25'),
    ('Leandro Bertocchi', '(49) 5555-5555', 'leandro@example.com', 'Centro', 'Rua E', 'Masculino', 'Guaraciaba', '1997-04-30'),
    ('Matheus Jos√©', '(49) 4444-4444', 'matheus@example.com', 'Centro', 'Rua F', 'Masculino', 'S√£o Miguel do Oeste', '1993-09-05'),
    ('N√≠colas Basotti', '(49) 3333-3333', 'nicolas@example.com', 'Agostini', 'Rua G', 'Masculino', 'Maravilha', '1996-06-18'),
    ('Iago Azevedo', '(49) 2222-2222', 'iago@example.com', 'Centro', 'Rua H', 'Masculino', 'Descanso', '1991-02-22'),
    ('Rafael Azevedo', '(49) 1111-1111', 'rafael@example.com', 'Agostini', 'Rua I', 'Masculino', 'Itapiranga', '1994-07-12'),
    ('Luis Paulo', '(49) 0000-0000', 'luis@example.com', 'Centro', 'Rua J', 'Masculino', 'Guaraciaba', '1999-12-31');
   
--------------------------------------------------------------------------------------------------------------------------------------------------

   --Inserts para Funcion√°rios
insert into funcionario (nomefun, telfun, emailfun, cargofun, salariofun) values
    ('NATANI GABRIELA GAYARDO', '(49) 1111-2222', 'natani@example.com', 'Barbeiro', 2500.00),
    ('JOHNNY MATHEUS NOGUEIRA DE MEDEIRO', '(49) 2222-3333', 'johnny@example.com', 'Cabeleireiro', 2800.00),
    ('ROBERSON JUNIOR FERNANDES ALVES', '(49) 3333-4444', 'roberson@example.com', 'Esteticista', 3000.00);
   
--------------------------------------------------------------------------------------------------------------------------------------------------

--Insert para Fornecedor
insert into fornecedor (nomeforn, telforn, emailforn, enderecoforn) values
    ('UNOESC', '(49) 9999-9999', 'unoesc@example.com', 'Rua Universit√°ria, 123');
   
--------------------------------------------------------------------------------------------------------------------------------------------------

--Inserts para Servi√ßos
insert into servico (nomeserv, descserv, precoserv) values
    ('Corte de Cabelo', 'Corte de cabelo masculino', 50.00),
    ('Barba', 'Barba completa', 30.00),
    ('Colora√ß√£o', 'Colora√ß√£o de cabelo', 80.00),
    ('Depila√ß√£o', 'Depila√ß√£o masculina', 100.00),
    ('Massagem Relaxante', 'Massagem corporal relaxante', 120.00);
   
--------------------------------------------------------------------------------------------------------------------------------------------------
    
--Inserts para Produtos
insert into produto (nomeprod, descprod, qtdprod, precoprod, fornecedorcodforn, servicocodserv) values
    ('Shampoo', 'Shampoo para cabelos masculinos', 100, 25.00, 1, null),
    ('Condicionador', 'Condicionador para cabelos masculinos', 80, 20.00, 1, null),
    ('Pomada Modeladora', 'Pomada modeladora para cabelos', 120, 35.00, 1, null),
    ('Cera Modeladora', 'Cera modeladora para cabelos', 90, 30.00, 1, null);

--------------------------------------------------------------------------------------------------------------------------------------------------

--Inserts para Agendamentos
insert into agendamento (data_hora, status, clientecodcli, funcionariocodfun) values
    ('2024-07-10 09:00:00', 'Agendado', 1, 1),
    ('2024-07-12 15:30:00', 'Agendado', 2, 2),
    ('2024-07-15 11:00:00', 'Agendado', 3, 3),
    ('2024-07-18 14:00:00', 'Agendado', 4, 1),
    ('2024-07-20 10:30:00', 'Agendado', 5, 2),
    ('2024-07-22 13:00:00', 'Agendado', 6, 3),
    ('2024-07-25 16:00:00', 'Agendado', 7, 1),
    ('2024-07-28 12:30:00', 'Agendado', 8, 2),
    ('2024-07-30 10:00:00', 'Agendado', 9, 3),
    ('2024-08-02 14:30:00', 'Agendado', 10, 1);
   
 --------------------------------------------------------------------------------------------------------------------------------------------------
  
 --Inserts para Pagamentos
insert into pagamento (valor, data_hora_pagamento, forma_pagamento, clientecodcli, agendamentocodagen) values
    (50.00, '2024-07-10 10:00:00', 'Dinheiro', 1, 1),
    (30.00, '2024-07-12 16:00:00', 'Cart√£o de D√©bito', 2, 2),
    (80.00, '2024-07-15 12:00:00', 'Cart√£o de Cr√©dito', 3, 3),
    (100.00, '2024-07-18 15:00:00', 'Dinheiro', 4, 4),
    (120.00, '2024-07-20 11:00:00', 'Cart√£o de Cr√©dito', 5, 5),
    (50.00, '2024-07-22 14:00:00', 'Dinheiro', 6, 6),
    (30.00, '2024-07-25 17:00:00', 'Cart√£o de D√©bito', 7, 7),
    (80.00, '2024-07-28 13:00:00', 'Cart√£o de Cr√©dito', 8, 8),
    (100.00, '2024-07-30 11:00:00', 'Dinheiro', 9, 9),
    (120.00, '2024-08-02 15:00:00', 'Cart√£o de Cr√©dito', 10, 10);

--------------------------------------------------------------------------------------------------------------------------------------------------
   
--Inserts para Hist√≥rico de Servi√ßos
insert into historico_servico (data_hora, servicocodserv, clientecodcli, funcionariocodfun) values
    ('2024-07-10 09:30:00', 1, 1, 1),
    ('2024-07-12 15:45:00', 2, 2, 2),
    ('2024-07-15 11:30:00', 3, 3, 3),
    ('2024-07-18 14:30:00', 4, 4, 1),
    ('2024-07-20 10:45:00', 5, 5, 2),
    ('2024-07-22 13:30:00', 1, 6, 3),
    ('2024-07-25 16:30:00', 2, 7, 1),
    ('2024-07-28 12:45:00', 3, 8, 2),
    ('2024-07-30 10:15:00', 4, 9, 3),
    ('2024-08-02 14:45:00', 5, 10, 1);

```
## üé≤Script - Selects/consultas
```sql
-- Select
SELECT * FROM cliente;
SELECT * FROM fornecedor;
SELECT * FROM funcionario;
SELECT * FROM servico;
SELECT * FROM produto;
SELECT * FROM agendamento;
SELECT * FROM pagamento;
SELECT * FROM historico_servico;

--Consulta: Clientes e Seus Agendamentos
SELECT c.nomcli, a.data_hora, a.status 
FROM cliente c
JOIN agendamento a ON c.codcli = a.clientecodcli;

--------------------------------------------------------------------------------------------
--Consulta: Funcion√°rios e Seus Agendamentos
SELECT f.nomefun, a.data_hora, a.status 
FROM funcionario f
JOIN agendamento a ON f.codfun = a.funcionariocodfun;

--------------------------------------------------------------------------------------------
--Consulta: Produtos e Seus Fornecedores

SELECT p.nomeprod, p.descprod, p.qtdprod, p.precoprod, f.nomeforn
FROM produto p
JOIN fornecedor f ON p.fornecedorcodforn = f.codforn;

--------------------------------------------------------------------------------------------
--Consulta: Servi√ßos Prestados com Detalhes de Clientes e Funcion√°rios

SELECT hs.data_hora, c.nomcli, s.nomeserv, s.descserv, f.nomefun
FROM historico_servico hs
JOIN cliente c ON hs.clientecodcli = c.codcli
JOIN servico s ON hs.servicocodserv = s.codserv
JOIN funcionario f ON hs.funcionariocodfun = f.codfun;

--------------------------------------------------------------------------------------------
--Consulta: Pagamentos Realizados por Cliente

SELECT p.valor, p.data_hora_pagamento, p.forma_pagamento, c.nomcli
FROM pagamento p
JOIN cliente c ON p.clientecodcli = c.codcli;

--------------------------------------------------------------------------------------------
--Consulta: Agendamentos com Detalhes de Clientes e Funcion√°rios
SELECT a.data_hora, a.status, c.nomcli, f.nomefun
FROM agendamento a
JOIN cliente c ON a.clientecodcli = c.codcli
JOIN funcionario f ON a.funcionariocodfun = f.codfun;

--------------------------------------------------------------------------------------------
--Consulta: Total de Pagamentos por Cliente
SELECT c.nomcli, SUM(p.valor) AS total_pago
FROM pagamento p
JOIN cliente c ON p.clientecodcli = c.codcli
GROUP BY c.nomcli;

--------------------------------------------------------------------------------------------
--Consulta: N√∫mero de Agendamentos por Funcion√°rio
SELECT f.nomefun, COUNT(a.codagen) AS total_agendamentos
FROM funcionario f
JOIN agendamento a ON f.codfun = a.funcionariocodfun
GROUP BY f.nomefun;

--------------------------------------------------------------------------------------------
--Consulta: Servi√ßos Mais Realizados
SELECT s.nomeserv, COUNT(hs.codhistorico) AS total_servicos
FROM servico s
JOIN historico_servico hs ON s.codserv = hs.servicocodserv
GROUP BY s.nomeserv
ORDER BY total_servicos DESC;
```
## üé≤Script de Consultas solicitadas pelo Professor
```sql
-- Clientes com idade abaixo de 40 anos e sexo masculino, ordenados pelo nome descendente
SELECT nomcli, dtnascli
FROM cliente
WHERE sexocli = 'Masculino' AND date_part('year', age(current_date, dtnascli)) < 40
ORDER BY nomcli DESC;

------------------------------------------------------------------------------------------------------------------------------------------------
--Servi√ßos registrados em meses sem a letra 'o' no final e de clientes nos bairros Centro e Agostini, ordenados pelo nome do cliente descendente
SELECT cli.nomcli, ser.nomeserv, to_char(hs.data_hora, 'Month') AS mes
FROM cliente cli
JOIN agendamento ag ON cli.codcli = ag.clientecodcli
JOIN historico_servico hs ON ag.codagen = hs.codhistorico
JOIN servico ser ON hs.servicocodserv = ser.codserv
WHERE cli.bairrocli IN ('Centro', 'Agostini')
  AND to_char(hs.data_hora, 'Month') !~ 'o$'
ORDER BY cli.nomcli DESC;

------------------------------------------------------------------------------------------------------------------------------------------------
-- Agendamentos de clientes com menos de 20 anos das cidades especificadas, ordenados por n√∫mero de agendamentos por cidade
SELECT cli.cidadecli, COUNT(*) AS num_agendamentos
FROM cliente cli
JOIN agendamento ag ON cli.codcli = ag.clientecodcli
WHERE date_part('year', age(current_date, cli.dtnascli)) < 20
  AND cli.cidadecli IN ('Maravilha', 'Descanso', 'Itapiranga', 'Guaraciaba')
GROUP BY cli.cidadecli
ORDER BY num_agendamentos DESC;

------------------------------------------------------------------------------------------------------------------------------------------------
-- Total de servi√ßos e valor total realizados por m√™s em 2024, ordenado do maior valor para o menor valor
SELECT to_char(data_hora, 'Month') AS mes,
       COUNT(*) AS total_servicos,
       SUM(ps.valor) AS valor_total
FROM pagamento ps
JOIN agendamento ag ON ps.agendamentocodagen = ag.codagen
WHERE date_part('year', ag.data_hora) = 2024
GROUP BY mes
ORDER BY valor_total DESC;



```

## üé≤Script de Exclus√£o das Tabelas
```sql
--Possuem chaves estrangeiras
DROP TABLE IF EXISTS historico_servico CASCADE;
DROP TABLE IF EXISTS pagamento CASCADE;
DROP TABLE IF EXISTS agendamento CASCADE;
DROP TABLE IF EXISTS produto CASCADE;

--tabelas referenciadas pelas anteriores
DROP TABLE IF EXISTS servico CASCADE;
DROP TABLE IF EXISTS funcionario CASCADE;
DROP TABLE IF EXISTS cliente CASCADE;
DROP TABLE IF EXISTS fornecedor CASCADE;
```
## üß†Desenvolvedores
| [<img src="https://avatars.githubusercontent.com/u/128015032?v=4" width=115><br><sub>Johnny Natheus Nogueira de Medeiro</sub>](https://github.com/JohnnyMatheus) |
| :---: | :---: |

## üî∑Professor
| [<img src="https://avatars.githubusercontent.com/u/1161348?v=4" width=115><br><sub>Roberson Alves</sub>](https://github.com/robersonjfa) |
| :---:
